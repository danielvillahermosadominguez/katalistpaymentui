
<!DOCTYPE html>
<html>
<head>
<title>Simulating codurance website</title>
</head>
<body>
<h1>Simulating codurance website</h1>
<p>Please fill the data and submit</p>


<form id="form_submit" method="post">
  <label for="email">Course ID:</label>
  <input type="text" id="courseId" name="courseId" value="11"><br><br>
  <label for="email">Email:</label>
  <input type="email" id="email" name="email" value="daniel.villahermosa@codurance.com"><br><br>
  <label for="email">Name:</label>
  <input type="text" id="name" name="name" value="John"><br><br>
  <label for="email">Surname:</label>
  <input type="text" id="surname" name="surname" value="Doe"><br><br>
  <label for="email">Company Name:</label>
  <input type="text" id="company" name="company" value="Brand Company"><br><br>
  <label for="dnicif">DNI/CIF:</label>
  <input type="text" id="dnicif" name="dnicif" value="46897454F"><br><br>
  <label for="dnicif">Payment method:</label>
  <select id="payment_method" name="payment_method" >
	<option value="Free">No payment</option>
	<option value="Paycomet">Payment</option>	
  </select>  <br><br>
  <input type="Button" value = "Submit" onclick="submitForm()">
 <!-- <a href="#" onclick="submitForm()">Submit Here</a>-->
</form>

<iframe title="titulo"  sandbox="allow-top-navigation allow-scripts allow-same-origin allow-forms" src="https://api.paycomet.com/gateway/ifr-bankstore?MERCHANT_MERCHANTCODE=0gs265nc" width="400" height="525" frameborder="1" marginheight="0" marginwidth="0" scrolling="no" style="border: 0px solid #000000; padding: 0px; margin: 0px"></iframe>

</body>
<script>
		
	
	function submitForm() {
		let url = "";
		let selector = document.getElementById("payment_method")		
		let payment_method = selector.value		
		if(payment_method === 'Free') {
			url = "http://localhost:8080/freesuscription"
		} else if(payment_method = 'Paycomet') {
			url = ""
		}			
						
		let formData = new FormData(document.getElementById('form_submit'))
		let json = JSON.stringify(Object.fromEntries(formData))		
		alert(json)
		fetch(url, {
				method: "POST",
				body: json
		}).then(response => {
			const data = response.json();
			if (response.ok){
				alert("Please, review your inbox. You should receive an email to start the payment with " + payment_method)
			} else {
				alert("It has been a problem with the process. Please try again")
			}
		})            	
			
	}
	
</script>

</html>
